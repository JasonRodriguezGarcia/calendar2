PARTIENDO DE 14InstalacionServidorTEST1.txt HASTA LA INSTALACION DE DOCKER ENGINE
SEGUIMOS ...

separar frontend y backend en contenedores es lo mÃ¡s limpio, incluso en Windows Server 2022.
Vamos a hacerlo bien y claro, usando Vite + Express, 2 contenedores, y Nginx delante.

Seguimos en Docker modo Windows (contenedores Windows).

ğŸ§± Arquitectura final
Docker
â”œâ”€ frontend  (Nginx + React build)
â”œâ”€ backend   (Node + Express)
â””â”€ (Postgres â†’ Supabase externo)


Flujo:

Usuario â†’ Nginx (frontend)
               â””â”€ /api â†’ Express (backend)

ğŸ“ Estructura del proyecto
project/
â”œâ”€ frontend/
â”‚  â”œâ”€ dist/              â† generado por Vite
â”‚  â”œâ”€ nginx.conf
â”‚  â””â”€ Dockerfile
â”œâ”€ backend/
â”‚  â”œâ”€ server.js
â”‚  â”œâ”€ package.json
â”‚  â””â”€ Dockerfile
â””â”€ docker-compose.yml

pasos, en orden, desde cero absoluto hasta contenedores levantados, pensando en Windows Server 2022 + Docker (Windows containers) y frontend/backend separados.

Respira ğŸ˜„ y sigue esto tal cual.

ğŸ§­ GUÃA COMPLETA DESDE CERO
0ï¸âƒ£ Requisitos previos

Debes tener:

Node.js instalado en el host (para crear proyectos y build)

Docker Engine + Docker Compose instalados

PowerShell como administrador

1ï¸âƒ£ Crear el directorio raÃ­z del proyecto
mkdir C:\projects\myapp
cd C:\projects\myapp


Este directorio contiene TODO.

2ï¸âƒ£ Crear el FRONTEND (React + Vite)

Desde la raÃ­z:

npm create vite@latest frontend


Selecciona:

Framework â†’ React

Variant â†’ JavaScript o TypeScript

Luego:

cd frontend
npm install
npm run dev


âœ”ï¸ Prueba: http://localhost:5173

Vuelve a la raÃ­z:

cd ..

3ï¸âƒ£ Crear el BACKEND (Express)
mkdir backend
cd backend
npm init -y
npm install express


Crea server.js:

const express = require("express");
const app = express();

const PORT = 3000;

app.get("/api/health", (req, res) => {
  res.json({ status: "ok" });
});

app.listen(PORT, () => {
  console.log(`Backend running on port ${PORT}`);
});


Prueba:

node server.js


âœ”ï¸ http://localhost:3000/api/health

Vuelve a la raÃ­z:

cd ..

4ï¸âƒ£ Build del frontend (Vite)
cd frontend
npm run build
cd ..


Esto crea:

frontend/dist/

5ï¸âƒ£ Crear archivos de Docker
ğŸ“ Estructura final
C:\projects\myapp
â”œâ”€ frontend
â”‚  â”œâ”€ dist
â”‚  â”œâ”€ Dockerfile
â”‚  â””â”€ nginx.conf
â”œâ”€ backend
â”‚  â”œâ”€ server.js
â”‚  â”œâ”€ package.json
â”‚  â””â”€ Dockerfile
â””â”€ docker-compose.yml

6ï¸âƒ£ Frontend â€” Nginx
frontend/nginx.conf
events {}

http {
  server {
    listen 80;

    root C:/nginx/html;
    index index.html;

    location / {
      try_files $uri /index.html;
    }

    location /api/ {
      proxy_pass http://backend:3000;
      proxy_http_version 1.1;
      proxy_set_header Host $host;
      proxy_set_header X-Real-IP $remote_addr;
    }
  }
}

frontend/Dockerfile
FROM mcr.microsoft.com/windows/servercore:ltsc2022

RUN powershell -Command `
  Invoke-WebRequest https://nginx.org/download/nginx-1.24.0.zip -OutFile nginx.zip ; `
  Expand-Archive nginx.zip C:/ ; `
  Rename-Item C:/nginx-1.24.0 C:/nginx ; `
  Remove-Item nginx.zip

COPY nginx.conf C:/nginx/conf/nginx.conf
COPY dist C:/nginx/html

EXPOSE 80
CMD ["C:/nginx/nginx.exe", "-g", "daemon off;"]

7ï¸âƒ£ Backend â€” Express
backend/Dockerfile
FROM mcr.microsoft.com/windows/servercore:ltsc2022

RUN powershell -Command `
  Invoke-WebRequest https://nodejs.org/dist/v18.20.4/node-v18.20.4-x64.msi -OutFile node.msi ; `
  Start-Process msiexec.exe -ArgumentList '/i node.msi /quiet' -Wait ; `
  Remove-Item node.msi

WORKDIR C:/app
COPY package.json .
RUN npm install --production
COPY . .

EXPOSE 3000
CMD ["node", "server.js"]

8ï¸âƒ£ Docker Compose
docker-compose.yml
version: "3.9"

services:
  backend:
    build: ./backend
    container_name: backend
    environment:
      - NODE_ENV=production
      - PORT=3000
    restart: always

  frontend:
    build: ./frontend
    container_name: frontend
    ports:
      - "80:80"
    depends_on:
      - backend
    restart: always

9ï¸âƒ£ Levantar TODO ğŸš€

Desde la raÃ­z:

docker compose up -d --build


Pruebas:

Web â†’ http://IP_DEL_SERVIDOR

API â†’ http://IP_DEL_SERVIDOR/api/health

ğŸŸ¢ QuÃ© has hecho (importante)

âœ”ï¸ Creaste un proyecto limpio
âœ”ï¸ Separaste frontend y backend
âœ”ï¸ Build de Vite correcto
âœ”ï¸ Docker construye imÃ¡genes
âœ”ï¸ Compose conecta servicios
âœ”ï¸ Arquitectura real de producciÃ³n

Si quieres, el siguiente paso natural es:

meter variables de entorno

aÃ±adir HTTPS

o ver cÃ³mo automatizar el build del frontend dentro de Docker

Dime y seguimos ğŸ’ªğŸ³