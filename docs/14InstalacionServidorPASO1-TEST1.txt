Xeon Bronze, Windows Server 2022, 32GB RAM, Disco duro de sobra en GB

Backend (Express)
    Node.js sobre Windows container
    Imagen base tipo:
       mcr.microsoft.com/windows/servercore


Express funciona sin problema

Frontend (React)

    Se builda (npm run build)
    Los archivos estÃ¡ticos:
        los sirve Express o
        un contenedor Nginx para Windows (mÃ¡s pesado)


Stack recomendado en Windows
Docker (Windows containers)
â””â”€ backend
   â”œâ”€ Express
   â””â”€ React (build estÃ¡tico)
(Postgres â†’ Supabase)

Pros y contras
Pros
Todo Windows
    Sin WSL2
    AdministraciÃ³n familiar
Contras
    ImÃ¡genes grandes
    Builds mÃ¡s lentos
    Menos ejemplos que en Linux
    Nginx en Windows es mÃ¡s tosco

ğŸŸ¢ ConclusiÃ³n clara
    âœ”ï¸ Docker + Compose sÃ­ funcionan en Windows
    âœ”ï¸ Express + React sÃ­ funcionan
    âš ï¸ No es lo mÃ¡s eficiente, pero es vÃ¡lido
    ğŸš€ Con tu hardware, no tendrÃ¡s problemas


Instalar Docker en Windows Server 2022.

Paso a paso, enfocado solo a Windows (sin WSL2)

ğŸ§± Paso 0 â€” Requisitos previos
En Windows Server 2022 necesitas:
    EdiciÃ³n Standard o Datacenter âœ…
    Acceso como Administrador
    Windows actualizado

ğŸ³ Paso 1 â€” Instalar Docker en Windows Server 2022
Abre PowerShell como Administrador y ejecuta:
    # Instala el proveedor de Docker
    Install-Module -Name DockerMsftProvider -Repository PSGallery -Force

    # Instala Docker Engine
    Install-Package -Name docker -ProviderName DockerMsftProvider -Force


Cuando termine:
    Restart-Computer -Force

ğŸ” Paso 2 â€” Verificar que Docker funciona

DespuÃ©s del reinicio:

docker version
docker info


Si ves informaciÃ³n del cliente y del servidor â†’ âœ”ï¸ Docker estÃ¡ instalado.

ğŸ§© Paso 3 â€” Poner Docker en modo Windows

En Server suele venir ya asÃ­, pero por si acaso:
    docker info | Select-String "OSType"

Debe decir:
    OSType: windows

ğŸ§ª Paso 4 â€” Probar un contenedor simple
        docker run hello-world
    Si imprime el mensaje de bienvenida â†’ ğŸ‰ listo.

ğŸ“¦ Paso 5 â€” Docker Compose
En versiones nuevas ya viene incluido:
    docker compose version
Si no:
    Install-Module DockerCompose -Force

ğŸŸ¢ A partir de aquÃ­
Ya puedes:
    crear Dockerfile
    usar docker compose up
    levantar Express + React
    conectar con Supabase

âš ï¸ Nota importante
    Esto instala Docker Engine, no Docker Desktop   !!!!!!!!!!!!!!!!!!
    Es la forma correcta en Windows Server
    No necesitas WSL2 para este modo

*************************
*************************
*************************
HASTA AQUI INSTALAMOS DOCKER ENGINE
*************************
*************************
*************************


Siguientes pasos:
    crear el Dockerfile Windows para Express
    preparar el build de React
    montar el compose completo

las 3 cosas:
1ï¸âƒ£ Dockerfile
2ï¸âƒ£ Build de React
3ï¸âƒ£ docker-compose.yml

Arquitectura simple y efectiva: un solo contenedor sirviendo Express + React.

ğŸ§± Estructura del proyecto
project/
â”œâ”€ backend/
â”‚  â”œâ”€ server.js
â”‚  â”œâ”€ package.json
â”‚  â””â”€ Dockerfile
â”œâ”€ frontend/
â”‚  â”œâ”€ package.json
â”‚  â””â”€ src/â€¦
â””â”€ docker-compose.yml

1ï¸âƒ£ Backend Express (sirviendo React)
backend/server.js
const express = require("express");
const path = require("path");

const app = express();
const PORT = process.env.PORT || 3000;

// API
app.get("/api/health", (req, res) => {
  res.json({ status: "ok" });
});

// React build
app.use(express.static(path.join(__dirname, "public")));

app.get("*", (req, res) => {
  res.sendFile(path.join(__dirname, "public", "index.html"));
});

app.listen(PORT, () => {
  console.log(`Server running on port ${PORT}`);
});

2ï¸âƒ£ Build de React

Desde la carpeta frontend:
    npm install
    npm run build

Eso genera:
    frontend/build/

Copia ese contenido a:
    backend/public/

ğŸ‘‰ En producciÃ³n React ya no corre, solo son archivos estÃ¡ticos.

3ï¸âƒ£ Dockerfile (Windows)
backend/Dockerfile: 

FROM mcr.microsoft.com/windows/servercore:ltsc2022

# Instalar Node.js
RUN powershell -Command `
  Invoke-WebRequest https://nodejs.org/dist/v18.20.4/node-v18.20.4-x64.msi -OutFile node.msi ; `
  Start-Process msiexec.exe -ArgumentList '/i node.msi /quiet' -Wait ; `
  Remove-Item node.msi

WORKDIR C:/app

COPY package.json .
RUN npm install --production

COPY . .

EXPOSE 3000
CMD ["node", "server.js"]

4ï¸âƒ£ docker-compose.yml

En la raÃ­z del proyecto:

version: "3.9"

services:
  app:
    build: ./backend
    ports:
      - "80:3000"
    environment:
      - NODE_ENV=production
      - PORT=3000
      # Supabase
      - DATABASE_URL=postgresql://USER:PASSWORD@HOST:5432/DB
    restart: always

ğŸš€ Levantar todo
Desde la carpeta raÃ­z:
    docker compose up -d --build

Luego abre:
    http://IP_DEL_SERVIDOR

y prueba:
    http://IP_DEL_SERVIDOR/api/health

ğŸŸ¢ QuÃ© tienes ahora

âœ”ï¸ Docker en Windows Server
âœ”ï¸ Express funcionando
âœ”ï¸ React servido correctamente
âœ”ï¸ Supabase externo
âœ”ï¸ Setup simple y estable

Con tu Xeon + 32 GB RAM, esto va sobrado.

******************
******************
******************
PERO USANDO VITE:
******************
******************
******************
Ajustamos lo anterior solo en el build del frontend, el resto (Docker + Express en Windows) queda igual.

ğŸ§± Cambios clave al usar React + Vite
ğŸ“Œ Idea importante
        Vite genera dist/, no build/
        En producciÃ³n NO corre Vite
        Express sirve los archivos estÃ¡ticos

1ï¸âƒ£ Build del frontend con Vite
Desde la carpeta frontend:
    npm install
    npm run build

Eso genera:
    frontend/dist/

Ahora copia todo el contenido de dist a:
    backend/public/

Debe quedar asÃ­:
backend/
â”œâ”€ public/
â”‚  â”œâ”€ index.html
â”‚  â”œâ”€ assets/
â”‚  â””â”€ â€¦

2ï¸âƒ£ Ajuste recomendado en vite.config.js
Para que funcione bien detrÃ¡s de Express/Nginx, revisa esto:

import { defineConfig } from "vite";
import react from "@vitejs/plugin-react";

export default defineConfig({
  plugins: [react()],
  base: "/",   // importante
});

Si no lo tienes, aÃ±Ã¡delo.

3ï¸âƒ£ Backend Express (sin cambios grandes)
Tu server.js ya estÃ¡ bien, solo confirmo la parte clave:
    app.use(express.static(path.join(__dirname, "public")));

    app.get("*", (req, res) => {
    res.sendFile(path.join(__dirname, "public", "index.html"));
    });

Esto es lo correcto para SPA + Vite.

4ï¸âƒ£ Dockerfile (sigue igual)
No hay cambios aquÃ­ ğŸ‘
Node + Express + estÃ¡ticos â†’ perfecto.

5ï¸âƒ£ Flujo correcto de trabajo (muy importante)
ğŸ” Cada vez que cambias el frontend:
        cd frontend
        npm run build
        # copiar dist â†’ backend/public
        docker compose up -d --build

En producciÃ³n, React solo son archivos.
ğŸŸ¢ Resultado final

âœ”ï¸ React con Vite
âœ”ï¸ Express sirviendo SPA
âœ”ï¸ Docker en Windows Server
âœ”ï¸ Supabase externo
âœ”ï¸ Setup limpio y estable

ğŸ’¡ Tip extra (opcional pero bueno)

En desarrollo:
    React (Vite) en localhost:5173
    Express en localhost:3000

En producciÃ³n:
    solo Docker
    solo Express

Si quieres, el siguiente paso puede ser:
    variables de entorno Vite (import.meta.env)

proxy /api en Vite para desarrollo

HTTPS o separar frontend/backend en contenedores
